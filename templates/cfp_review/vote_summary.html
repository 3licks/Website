{% extends "cfp_review/base.html" %}
{% block body %}
<h2>Votes summary</h2>

<div class="row">
    <div class="col-md-6">
        <h4>Votes</h4>
        <dl class="dl-horizontal">
            <dt>Min</dt>
            <dd>{{ summary.get('min_votes', 0) }}</dd>
            <dt>Max</dt>
            <dd>{{ summary.get('max_votes', 0) }}</dd>
            <dt>Ave</dt>
            <dd>{{ (summary.get('votes_total', 0) / (proposals_with_counts | count) ) | round }}</dd>
            <dt>Total</dt>
            <dd>{{ summary.get('votes_total', 0)}}</dd>
        </dl>
    </div>
    <div class="col-md-6">
        <h4>Status</h4>
        <dl class="dl-horizontal">
            <dt>Notes</dt><dd>{{ summary.get('notes_unread', 0) }}/{{ summary.get('notes_total', 0) }}</dd>
            <dt>Blocked</dt><dd>{{ summary.get('block_total', 0) }}</dd>
            <dt>Recused</dt><dd>{{ summary.get('recused_total', 0) }}</dd>
        </dl>
    </div>
</div>

<table class="table table-striped">
    <tr>
        <th class="text-center">Date</th>
        <th class="text-center">Notes</th>
        <th class="text-center">Votes</th>
        <th class="text-center">Blocked</th>
        <th class="text-center">Recused</th>
        <th>Proposal Title</th>
    </tr>
{% for proposal, counts in proposals_with_counts %}
    <tr>
        <td class="text-center">{{ proposal.created.strftime("%d/%m") }}</td>
        <td class="text-center">
            {{ proposal.get_unread_vote_note_count() }}/{{ proposal.get_total_note_count() }}
        </td>
        <td class="text-center">{{ counts.get('voted', 0) }}</td>
        <td class="text-center">{{ counts.get('blocked', 0) }}</td>
        <td class="text-center">{{ counts.get('recused', 0) }}</td>
        <td>
            <a href="{{ url_for('.proposal_votes', proposal_id=proposal.id) }}">
                {{ proposal.title }}
            </a>
        </td>
    </tr>
{% endfor %}
</table>

{% endblock %}