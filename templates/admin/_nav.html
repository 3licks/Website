{% macro badge(count) %}
    {% if count > 0 %}
        <span class="badge">{{count}}</span>
    {% endif %}
{% endmacro %}

{% macro menuitem(text, view, badge_count=0) %}
<li {% if view_name == view -%} class="active" {%- endif %}>
    <a href="{{url_for(view)}}">{{text}}{{badge(badge_count)}}</a>
</li>
{% endmacro %}

<ul class="nav navbar-nav">
    {% if current_user.has_permission('admin') %}
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
            aria-haspopup="true" aria-expanded="false">Payments
            {# {{badge(unreconciled_count + expiring_count)}} #}
            <span class="caret"></span></a>
        <ul class="dropdown-menu">
            {{ menuitem("All", "admin.payments") }}
            {# {{ menuitem("Bank Transfer", "admin.transactions", unreconciled_count) }} #}
            {{ menuitem("Bank Transfer", "admin.transactions") }}
            {# {{ menuitem("Expiring", "admin.expiring", expiring_count) }} #}
            {{ menuitem("Expiring", "admin.expiring") }}
            {{ menuitem("Suppressed Transactions", "admin.suppressed") }}
        </ul>
    </li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
            aria-haspopup="true" aria-expanded="false">Tickets <span class="caret"></span></a>
        <ul class="dropdown-menu">
            {{ menuitem("Transfers", "admin.ticket_transfers") }}
            {{ menuitem("Ticket Types", "admin.ticket_types") }}
        </ul>
    </li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
            aria-haspopup="true" aria-expanded="false">CfP <span class="caret"></span></a>
        <ul class="dropdown-menu">
            {{ menuitem("Proposals", "cfp_review.cfp_proposals") }}
            {{ menuitem("Categories", "cfp_review.cfp_categories") }}
        </ul>
    </li>
    {{ menuitem("Users", "admin.users") }}
    {{ menuitem("Feature Flags", "admin.feature_flags") }}
{% endif %}
</ul>
